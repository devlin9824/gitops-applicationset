# apps-config/firewall-integration-admin/values.yaml

image:
  registry: docker.io
  repository: d4vlin/firewall-service
  tag: "test-v4-libstdcpp"

containerPorts:
  http: 8080

replicaCount: 1  # admin thường 1 replica cũng được (tuỳ nhu cầu)

service:
  type: ClusterIP
  port: 8080
  targetPort:
    http: 8080

env:
  LOG_LEVEL: "info"
  ADMIN_ENABLED: "true"

  # PRODUCTION: sau khi bạn tạo "DB-backed admin key" (POST /admin/api-keys)
  # thì để FALSE và (khuyến nghị) bỏ ADMIN_API_KEY khỏi secret.
  ALLOW_BOOTSTRAP_ADMIN_API_KEY: "true"

extraEnv:
  - name: DATABASE_URL
    valueFrom:
      secretKeyRef:
        name: firewall-integration-admin-env
        key: DATABASE_URL
  - name: API_KEY_PEPPER
    valueFrom:
      secretKeyRef:
        name: firewall-integration-admin-env
        key: API_KEY_PEPPER

  # BOOTSTRAP KEY (chỉ dùng 1 lần để tạo key DB-backed rồi tắt)
  - name: ADMIN_API_KEY
    valueFrom:
      secretKeyRef:
        name: firewall-integration-admin-env
        key: ADMIN_API_KEY

# QUAN TRỌNG: admin instance KHÔNG public
gatewayApi:
  enabled: false

# ĐỂ KHỚP service selector hiện tại: app=firewall-integration-admin,role=admin
podLabels:
  role: admin

resources:
  requests:
    cpu: 50m
    memory: 128Mi
  limits:
    cpu: 300m
    memory: 512Mi
